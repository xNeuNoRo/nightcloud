/**
 * Esquema de Prisma para la app NightCloud.
 * Define el modelo de datos y la configuración de la base de datos.
 */
generator client {
    provider   = "prisma-client" // Usar el cliente de Prisma
    output     = "./generated" // Generar a nivel relativo a este archivo en la carpeta "generated"
    engineType = "client" // Tipo de motor del cliente
}

// Configuración del datasource para PostgreSQL
datasource db {
    provider = "postgresql"
}

/**
 * Modelo que representa un nodo en el sistema de archivos.
 * Puede ser un archivo o un directorio.
 */
model Node {
    // Campos del modelo
    id         String   @id @default(uuid()) @db.Uuid
    parentId   String?  @db.Uuid
    name       String
    hash       String   @unique
    size       BigInt
    mime       String
    isDir      Boolean  @default(false)
    createdAt  DateTime @default(now())
    updatedAt  DateTime @updatedAt
    parent     Node?    @relation("ParentNode", fields: [parentId], references: [id])
    children   Node[]   @relation("ParentNode")

    // Indice para optimizar consultas por parentId y hash
    @@index([parentId, hash])
    // Remapeo de la tabla a "node"
    @@map("node")
}
